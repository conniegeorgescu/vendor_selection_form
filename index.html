<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Selection Form</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;

        // PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL HERE
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwcC2JnuV5khkOYFfzxp9s_AI2kmWy5ZfNCSVM4MjBM3jZKj3eLhp-ViXy0I57ekDd-9w/exec';

        function VendorSelectionForm() {
          const vendors = [
            'APC', 'Avast', 'Fellowes', 'HP', 'iStorage', 'Lenovo', 
            'Logitech', 'Philips', 'Samsung Mobile', 'Synology', 'TP Link'
          ];

          const salesTeam = [
            'Adam Iqbal', 'Arran Bal', 'Clare Douglas', 'David Holland', 'David Matthews',
            'David Walshe', 'Elliott Yates', 'Hasan Haideri', 'Jason Curtis', 'Jat Tumber',
            'Jenny Hodson', 'Jonathan Ashfall', 'Jon Garvey', 'Karen Burton', 'Keane Richards',
            'Klaudia Borun', 'Madison Moss-Williams', 'Mat Pyle', 'Michael Addinell', 'Michael Doherty',
            'Mike Leigh', 'Nourelhuda El Magbari', 'Paul Rennals', 'Paul Sellers', 'Ray Parmar',
            'Rourke Smal', 'Scott Hancock', 'Sarah Lyons', 'Tom Bestwick', 'Zahid Hussain'
          ];

          const [selectedName, setSelectedName] = useState('');
          const [selectedVendors, setSelectedVendors] = useState([]);
          const [showSuccess, setShowSuccess] = useState(false);
          const [showError, setShowError] = useState(false);
          const [isSubmitting, setIsSubmitting] = useState(false);
          const [hasSubmitted, setHasSubmitted] = useState(false);

          const handleVendorToggle = (vendor) => {
            if (hasSubmitted) return;
            if (selectedVendors.includes(vendor)) {
              setSelectedVendors(selectedVendors.filter(v => v !== vendor));
            } else {
              setSelectedVendors([...selectedVendors, vendor]);
            }
          };

          const handleSubmit = async (e) => {
            e.preventDefault();
            if (selectedName && selectedVendors.length >= 5 && !hasSubmitted) {
              setIsSubmitting(true);
              setShowError(false);

              try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                  method: 'POST',
                  mode: 'no-cors',
                  headers: {
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({
                    name: selectedName,
                    vendors: selectedVendors
                  })
                });

                setShowSuccess(true);
                setHasSubmitted(true);
              } catch (error) {
                console.error('Error:', error);
                setShowError(true);
                setTimeout(() => setShowError(false), 5000);
              } finally {
                setIsSubmitting(false);
              }
            }
          };

          if (hasSubmitted) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
                <div className="max-w-4xl mx-auto">
                  <div className="bg-white rounded-xl shadow-lg p-8">
                    <h1 className="text-3xl font-bold text-gray-800 mb-2">Thank You!</h1>
                    <p className="text-gray-600 mb-6">Your vendor selection has been recorded.</p>
                    
                    <div className="mb-6">
                      <h2 className="text-lg font-semibold text-gray-700 mb-2">Your Submission:</h2>
                      <div className="bg-gray-50 rounded-lg p-4">
                        <p className="text-gray-700"><strong>Name:</strong> {selectedName}</p>
                        <p className="text-gray-700 mt-2"><strong>Selected Vendors:</strong></p>
                        <ul className="list-disc list-inside mt-1 text-gray-600">
                          {selectedVendors.map(vendor => (
                            <li key={vendor}>{vendor}</li>
                          ))}
                        </ul>
                      </div>
                    </div>
                    
                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                      <p className="text-blue-800">
                        You have already submitted your vendor selection. If you need to make changes, please contact the administrator.
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
              <div className="max-w-4xl mx-auto">
                <div className="bg-white rounded-xl shadow-lg p-8">
                  <h1 className="text-3xl font-bold text-gray-800 mb-2">Vendor Selection Form</h1>
                  <p className="text-gray-600 mb-6">Select at least 5 vendors you'd like to meet (you can select more)</p>
                  
                  {showError && (
                    <div className="mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3">
                      <svg className="text-red-600" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="15" y1="9" x2="9" y2="15"></line>
                        <line x1="9" y1="9" x2="15" y2="15"></line>
                      </svg>
                      <span className="text-red-800 font-medium">There was an error submitting your response. Please try again.</span>
                    </div>
                  )}

                  <div>
                    <div className="mb-6">
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        Your Name *
                      </label>
                      <select
                        value={selectedName}
                        onChange={(e) => setSelectedName(e.target.value)}
                        className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                        required
                        disabled={isSubmitting}
                      >
                        <option value="">-- Select your name --</option>
                        {salesTeam.map(name => (
                          <option key={name} value={name}>{name}</option>
                        ))}
                      </select>
                    </div>

                    <div className="mb-6">
                      <div className="flex justify-between items-center mb-3">
                        <label className="block text-sm font-semibold text-gray-700">
                          Select Vendors (minimum 5) *
                        </label>
                        <span className={`text-sm font-medium ${selectedVendors.length >= 5 ? 'text-green-600' : 'text-gray-500'}`}>
                          {selectedVendors.length} selected {selectedVendors.length >= 5 && 'âœ“'}
                        </span>
                      </div>
                      
                      <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                        {vendors.map(vendor => {
                          const isSelected = selectedVendors.includes(vendor);
                          
                          return (
                            <button
                              key={vendor}
                              type="button"
                              onClick={() => handleVendorToggle(vendor)}
                              disabled={isSubmitting}
                              className={`p-4 rounded-lg border-2 transition-all ${
                                isSelected
                                  ? 'border-indigo-500 bg-indigo-50 text-indigo-700 font-semibold'
                                  : 'border-gray-300 bg-white hover:border-indigo-300 hover:bg-indigo-50'
                              } ${isSubmitting ? 'opacity-50 cursor-not-allowed' : ''}`}
                            >
                              {vendor}
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    {selectedVendors.length > 0 && selectedVendors.length < 5 && (
                      <div className="mb-6 bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-center gap-3">
                        <svg className="text-amber-600" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <circle cx="12" cy="12" r="10"></circle>
                          <line x1="12" y1="8" x2="12" y2="12"></line>
                          <line x1="12" y1="16" x2="12.01" y2="16"></line>
                        </svg>
                        <span className="text-amber-800 text-sm">
                          Please select at least 5 vendors ({5 - selectedVendors.length} more needed)
                        </span>
                      </div>
                    )}

                    <button
                      type="button"
                      onClick={handleSubmit}
                      disabled={!selectedName || selectedVendors.length < 5 || isSubmitting}
                      className="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"
                    >
                      {isSubmitting ? (
                        <>
                          <svg className="animate-spin h-5 w-5" viewBox="0 0 24 24">
                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4" fill="none"></circle>
                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                          </svg>
                          Submitting...
                        </>
                      ) : (
                        'Submit Selection'
                      )}
                    </button>
                  </div>
                </div>
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<VendorSelectionForm />);
    </script>
</body>
</html>
